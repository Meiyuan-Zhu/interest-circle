"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const webLoader_1 = require("./webLoader");
class AppWorkerLoader extends webLoader_1.MidwayWebLoader {
    /**
     * Load all directories in convention
     * @since 1.0.0
     */
    load() {
        // app > plugin > core
        this.loadApplicationExtend();
        this.loadRequestExtend();
        this.loadResponseExtend();
        this.loadContextExtend();
        this.loadHelperExtend();
        this.loadApplicationContext();
        // app > plugin
        this.loadCustomApp();
        // app > plugin
        this.loadService();
        // app > plugin > core
        this.loadMiddleware();
        // app
        this.loadController();
        // app
        this.loadRouter(); // Dependent on controllers
        // midway logic
        this.app.beforeStart(async () => {
            await this.refreshContext();
            await this.loadMidwayController();
        });
        this.app.beforeClose(async () => {
            await this.onClose();
        });
    }
}
exports.AppWorkerLoader = AppWorkerLoader;
class AgentWorkerLoader extends webLoader_1.MidwayWebLoader {
    load() {
        this.loadAgentExtend();
        this.loadApplicationContext();
        this.loadContextExtend();
        this.loadCustomAgent();
        this.app.beforeStart(async () => {
            await this.refreshContext();
        });
        this.app.beforeClose(async () => {
            await this.onClose();
        });
    }
}
exports.AgentWorkerLoader = AgentWorkerLoader;
//# sourceMappingURL=loader.js.map